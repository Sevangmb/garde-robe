{% extends 'vetements/base.html' %}

{% block title %}{{ valise.nom }} - Ma Garde-Robe{% endblock %}

{% block content %}
<div class="page-header">
    <h1>ğŸ§³ {{ valise.nom }}</h1>
    <span class="badge {% if valise.statut == 'prete' %}success{% elif valise.statut == 'en_cours' %}warning{% endif %}">
        {{ valise.get_statut_display }}
    </span>
</div>

<div class="section">
    <h2>Informations du voyage</h2>
    <div class="info-grid">
        <div class="info-item">
            <strong>ğŸ“ Destination:</strong>
            <span>{{ valise.destination }}</span>
        </div>
        <div class="info-item">
            <strong>ğŸ’ Type de voyage:</strong>
            <span>{{ valise.get_type_voyage_display }}</span>
        </div>
        <div class="info-item">
            <strong>ğŸ“… Date de dÃ©part:</strong>
            <span>{{ valise.date_depart|date:"l d F Y" }}</span>
        </div>
        <div class="info-item">
            <strong>ğŸ“… Date de retour:</strong>
            <span>{{ valise.date_retour|date:"l d F Y" }}</span>
        </div>
        <div class="info-item">
            <strong>â±ï¸ DurÃ©e:</strong>
            <span>{{ valise.duree_sejour }} jour(s)</span>
        </div>
        {% if valise.meteo_prevue %}
        <div class="info-item">
            <strong>ğŸŒ¤ï¸ MÃ©tÃ©o prÃ©vue:</strong>
            <span>{{ valise.meteo_prevue }}</span>
        </div>
        {% endif %}
        {% if valise.climat %}
        <div class="info-item">
            <strong>ğŸŒ¡ï¸ Climat:</strong>
            <span>{{ valise.climat }}</span>
        </div>
        {% endif %}
        {% if valise.checklist_faite %}
        <div class="info-item">
            <strong>âœ… Checklist:</strong>
            <span class="alert success">ComplÃ©tÃ©e</span>
        </div>
        {% else %}
        <div class="info-item">
            <strong>â³ Checklist:</strong>
            <span class="alert warning">En cours</span>
        </div>
        {% endif %}
    </div>
</div>

{% if valise.notes %}
<div class="section">
    <h2>ğŸ“ Notes</h2>
    <div class="notes-box">
        {{ valise.notes|linebreaks }}
    </div>
</div>
{% endif %}

{% if valise.tenues.exists %}
<div class="section">
    <h2>ğŸ‘— Tenues prÃ©vues ({{ valise.tenues.count }})</h2>
    <div class="tenues-grid">
        {% for tenue in valise.tenues.all %}
        <div class="tenue-card">
            <h3>{{ tenue.nom }}</h3>
            {% if tenue.image %}
            <img src="{{ tenue.image.url }}" alt="{{ tenue.nom }}" class="tenue-image">
            {% endif %}
            <p><strong>ğŸ¯ Occasion:</strong> {{ tenue.get_occasion_display }}</p>
            <p><strong>ğŸ‚ Saison:</strong> {{ tenue.get_saison_display }}</p>
            <p><strong>ğŸ‘• PiÃ¨ces:</strong> {{ tenue.vetements.count }} vÃªtement(s)</p>
            <a href="{% url 'vetements:tenue_detail' tenue.pk %}" class="btn btn-small">Voir dÃ©tails</a>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}

<div class="section">
    <h2>ğŸ‘• VÃªtements dans la valise ({{ valise.nombre_vetements }})</h2>
    {% if valise.vetements.exists %}
    <div class="vetements-grid">
        {% for vetement in valise.vetements.all %}
        <div class="vetement-card">
            {% if vetement.image %}
            <img src="{{ vetement.image.url }}" alt="{{ vetement.nom }}" class="vetement-image">
            {% endif %}
            <h3>{{ vetement.nom }}</h3>
            <p><strong>ğŸ“‚ CatÃ©gorie:</strong> {{ vetement.categorie.nom }}</p>
            {% if vetement.couleur %}
            <p><strong>ğŸ¨ Couleur:</strong> {{ vetement.couleur.nom }}</p>
            {% endif %}
            {% if vetement.taille %}
            <p><strong>ğŸ“ Taille:</strong> {{ vetement.taille.nom }}</p>
            {% endif %}
            <p><strong>ğŸ“Š Ã‰tat:</strong> {{ vetement.get_etat_display }}</p>
            {% if vetement.a_laver %}
            <p class="alert warning">ğŸ§º Ã€ laver avant le dÃ©part!</p>
            {% endif %}
            <a href="{% url 'vetements:detail_vetement' vetement.pk %}" class="btn btn-small">Voir dÃ©tails</a>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="alert">
        <p>Aucun vÃªtement ajoutÃ© Ã  cette valise.</p>
        <p>Utilisez l'interface d'administration pour ajouter des vÃªtements.</p>
    </div>
    {% endif %}
</div>

{% if valise.liste_articles_supplementaires %}
<div class="section">
    <h2>ğŸ’ Autres articles Ã  emporter</h2>
    <div class="notes-box">
        {{ valise.liste_articles_supplementaires|linebreaks }}
    </div>
</div>
{% endif %}

<div class="section">
    <h3>ğŸ“Š RÃ©sumÃ© du contenu</h3>
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-value">{{ valise.nombre_vetements }}</div>
            <div class="stat-label">VÃªtements</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">{{ valise.tenues.count }}</div>
            <div class="stat-label">Tenues complÃ¨tes</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">{{ valise.duree_sejour }}</div>
            <div class="stat-label">Jours de voyage</div>
        </div>
    </div>
</div>

<div class="section">
    <h3>ğŸ”§ Mettre Ã  jour le statut</h3>
    <form method="post" action="{% url 'vetements:valise_update_status' valise.pk %}" class="status-form">
        {% csrf_token %}
        <div class="form-inline">
            <select name="statut" class="form-control">
                <option value="preparation" {% if valise.statut == 'preparation' %}selected{% endif %}>En prÃ©paration</option>
                <option value="prete" {% if valise.statut == 'prete' %}selected{% endif %}>PrÃªte</option>
                <option value="en_cours" {% if valise.statut == 'en_cours' %}selected{% endif %}>En cours de voyage</option>
                <option value="terminee" {% if valise.statut == 'terminee' %}selected{% endif %}>TerminÃ©e</option>
            </select>

            <label class="checkbox-inline">
                <input type="checkbox" name="checklist_faite" {% if valise.checklist_faite %}checked{% endif %}>
                Checklist complÃ©tÃ©e
            </label>

            <button type="submit" class="btn btn-primary">Mettre Ã  jour</button>
        </div>
    </form>
</div>

<div class="actions">
    <a href="{% url 'vetements:valises_list' %}" class="btn btn-secondary">â¬…ï¸ Retour aux valises</a>
    <a href="{% url 'vetements:valise_edit' valise.pk %}" class="btn">âœï¸ Modifier les infos</a>
    <a href="{% url 'vetements:valise_edit_content' valise.pk %}" class="btn">ğŸ“¦ Modifier le contenu</a>
    <a href="{% url 'vetements:valise_copy' valise.pk %}" class="btn">ğŸ“‹ Copier cette valise</a>
    <a href="{% url 'vetements:valise_delete' valise.pk %}" class="btn btn-danger" onclick="return confirm('ÃŠtes-vous sÃ»r de vouloir supprimer cette valise ?')">ğŸ—‘ï¸ Supprimer</a>
</div>

<style>
.status-form {
    background-color: var(--bg-secondary);
    padding: 1.5rem;
    border-radius: 8px;
    border: 1px solid var(--border-color);
}

.form-inline {
    display: flex;
    gap: 1rem;
    align-items: center;
    flex-wrap: wrap;
}

.form-control {
    padding: 0.5rem;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    font-size: 1rem;
}

.checkbox-inline {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
}

.checkbox-inline input[type="checkbox"] {
    width: 20px;
    height: 20px;
    cursor: pointer;
}

.actions {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
    padding-top: 2rem;
    border-top: 2px solid var(--border-color);
    margin-top: 2rem;
}

.btn-danger {
    background-color: var(--danger-color);
    color: white;
}

.btn-danger:hover {
    background-color: #c82333;
}

@media (max-width: 768px) {
    .form-inline {
        flex-direction: column;
        align-items: stretch;
    }

    .actions {
        flex-direction: column;
    }

    .actions .btn {
        width: 100%;
        text-align: center;
    }
}
</style>
{% endblock %}
